# 风险评估模型训练与预测结果报告

## 项目概述
本项目使用真实的金融风控数据，训练了三种机器学习模型来预测用户的违约风险。

## 数据集信息

### 训练数据
- **文件**: `train_new.csv`
- **样本数量**: 50,000条
- **特征数量**: 72个特征（X1-X72）
- **目标变量**: Y（违约标签：0=正常，1=违约）

### 测试数据
- **文件**: `test_new.csv`
- **样本数量**: 10,000条
- **特征数量**: 72个特征（X1-X72）
- **目标变量**: 无标签（需要预测）

### 特征说明
参考文件 `feature_x.csv` 包含了所有72个特征的详细说明，主要包括：
- **用户基本信息**: 手机号归属地、籍贯等
- **通话行为数据**: 近六个月通话次数、主叫被叫统计等
- **金融行为数据**: 借款次数、履约次数、与黑名单用户联系次数等
- **应用使用数据**: 安装应用数量、搜索行为等
- **通信消费数据**: 话费余额、套餐使用情况等

## 模型训练与评估

### 模型性能对比
通过5折交叉验证评估，各模型的AUC指标如下：

| 模型 | 平均AUC | 标准差 | 各折AUC得分 |
|------|---------|---------|-------------|
| **LightGBM** | **0.7398** | 0.0018 | [0.7388, 0.7369, 0.7401, 0.7410, 0.7421] |
| **GBDT** | 0.7264 | 0.0031 | [0.7245, 0.7216, 0.7297, 0.7267, 0.7295] |
| **逻辑回归** | 0.5101 | 0.0056 | [0.5042, 0.5159, 0.5025, 0.5148, 0.5129] |

### 最佳模型选择
**LightGBM** 表现最佳，平均AUC为0.7398，被选为最终预测模型。

## 预测结果

### 测试集预测统计
使用LightGBM模型对10,000条测试数据进行预测：

- **预测为正常（0）**: 6,955条（69.55%）
- **预测为违约（1）**: 3,045条（30.45%）
- **平均预测概率**: 0.3865

### 预测概率分布
- **最小概率**: 0.0432
- **25%分位数**: 0.2616
- **中位数**: 0.3658
- **75%分位数**: 0.4999
- **最大概率**: 0.8486

## 文件输出

### 模型文件
- `models/lr/` - 逻辑回归模型
- `models/gbdt/` - GBDT模型  
- `models/lightgbm/` - LightGBM模型

### 预测结果文件
- `results/predictions/best_model_test_predictions.csv` - 最佳模型预测结果
- `results/predictions/logistic_regression_test_predictions.csv` - 逻辑回归预测结果
- `results/predictions/gbdt_test_predictions.csv` - GBDT预测结果
- `results/predictions/lightgbm_test_predictions.csv` - LightGBM预测结果

### 评估结果文件
- `results/metrics/cross_validation_results.json` - 交叉验证详细结果

## 结论

1. **模型性能**: LightGBM在交叉验证中表现最佳，AUC达到0.7398，说明模型具有较好的风险识别能力。

2. **预测分布**: 在10,000条测试数据中，模型预测约30.45%的用户存在违约风险，这个比例在金融风控场景中是合理的。

3. **业务应用**: 模型可以为金融机构提供风险预警，建议对预测概率较高的用户进行更严格的审核。

4. **模型优化**: 未来可以考虑特征工程优化、超参数调优、集成学习等方法进一步提升模型性能。